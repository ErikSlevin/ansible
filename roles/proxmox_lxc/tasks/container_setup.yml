---
# Container Post-Deployment Setup fÃ¼r Debian
- name: "System-Setup lÃ¤uft"
  shell: |
    pct exec {{ container_id }} -- bash -c '
    export DEBIAN_FRONTEND=noninteractive
    export APT_LISTCHANGES_FRONTEND=none
    export LC_ALL=C

    apt-get -qq update &&
    apt-get -qq upgrade -y &&
    apt-get -qq install -y locales &&

    echo "de_DE.UTF-8 UTF-8" >> /etc/locale.gen &&
    locale-gen de_DE.UTF-8 &&
    update-locale LANG=de_DE.UTF-8 LC_ALL=de_DE.UTF-8 &&

    ln -sf /usr/share/zoneinfo/Europe/Berlin /etc/localtime &&
    echo "Europe/Berlin" > /etc/timezone
    '
  register: setup_result
  changed_when: setup_result.rc == 0
  failed_when: setup_result.rc != 0
