# Container-Erstellung
# Erstellt den LXC Container mit allen angegebenen Parametern

- name: "Erstelle LXC Container {{ container_id }}"
  shell: |
    pct create {{ container_id }} {{ container_template }} \
      --hostname {{ container_hostname }} \
      --storage {{ container_storage }} \
      --cores {{ container_cores }} \
      --memory {{ container_memory }} \
      --rootfs {{ container_storage }}:{{ container_rootfs_size }} \
      --net0 name=eth0,bridge=vmbr0,tag={{ container_vlan }},ip={{ container_ip }}{% if container_ip != 'dhcp' %}/24,gw=10.{{ container_vlan }}.0.1{% endif %} \
      --unprivileged 1 \
      --tags {{ container_tags }}
  register: container_create_result
  tags: create
